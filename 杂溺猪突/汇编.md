# 汇编

---

### 一、预备知识

> 汇编指令可以通过编译器翻译成机器指令。
>
> 指令和数据存放在内存中
>
> 指令和数据存放在内存中是没有区别的，都是以二进制存储
>
> 内存编号是从 0 开始的
>
> 内存的最小单元是字节，2 个十六进制位，1byte = 8bit
>
> CPU 中也存放了一部分指令和数据
>
> 地址线决定了 CPU 的寻址能力，即能够找到多大的地址
>
> 数据线决定了 CPU 一次能够传送多少字节的数据
>
> 控制线决定了 CPU 对其他部件的控制能力。
>
> 例：1024 个内存单元的编号是从 0 ~ 1023，即 10 个 0 到 10 个 1 
>
> CPU 将内存条，显存，ROM 内存都看成内存空间，对内存空间进行了编号
>
> 内存有 ROM（只读存储器）和 RAM（随机存储器）形式
>
> CPU 通过端口去访问键盘、鼠标；通过内存地址去访问内存条、显存、ROM
>
> CPU 内部有保存地址信息和数据信息的地方，寄存器
>
> 8080，8088，80286，80386的地址总线宽度分别为 16 根，20 根，24 根，32 根，则他们的寻址能力分别为 64KB，1MB，16MB，4GB。
>
> 8080，8088，8086，80286，80386的数据总线宽度分别为 8 根，8 根，16 根，16 根，32 根，则他们依次可以传送的数据为 1Byte，1Byte，2Byte，2Byte，4Byte。
>
> - 

+ DOSBox 基础
  + debug 模式下，输入 u 指令，我们看到的是机器指令和汇编指令。
  + debug 模式下，输入 d 指令，我们看到的是数据。
  + 输入 e 指令，进入输入编辑模式
  + 输入 r 指令，显示各个寄存器
  + 输入 a 指令，进入输入指令模式
  + 输入 t 指令，执行一条指令

### 二、寄存器

> 汇编程序就是通过汇编语言中的汇编指令来修改寄存器中的内容，从而控制 CPU，来操作整个计算机。

+ AX、BX、CX、DX。16位寄存器， 范围 0 ~ 65535。通用寄存器，也叫数据寄存器。
+ AX = AH + AL，BX = BH + BL，CX = CH + CL，DX = DH + DL；8 位寄存器，范围 0 ~ 255。
+ 8086CPU 一次可以处理两种尺寸的数据：
  - 字节型数据  1Byte = 8bit，存放在 8 位寄存器中
  - 字型数据  2Byte = 16bit，存放在16位寄存器中 
+ MOV 指令，将逗号右边的数据、寄存器赋值给左边的寄存器
+ 在使用 MOV 时，要保证数据与寄存器、寄存器与寄存器之间位数的一致性
+ 16 位寄存器进行 16 位运算，保存 16 位数据；8 位寄存器进行 8 位运算，保存 8 位数据。
+ 段地址 * 16 + 偏移地址 = 物理地址，因为 8086CPU 有 20 根地址线，16 位寄存器无法表示，所以采用这种计算方式。
+ CPU 在任意时刻，将段地址寄存器 CS 和偏移地址寄存器 IP 组合出来的地址作为起始，从中读取的内容当作指令
+ 指令是有长度的，一条指令可以由多个字节构成，IP 寄存器和指令长度有关系
+ 指令的执行过程
  1. CPU 从 CS:IP 所指向的内存单元读取指令，存放到指令缓存器中。
  2. IP = IP + 所读取指令的长度，从而指向下一条指令。
  3. 执行指令缓存器中的内容，回到步骤 1。

### 三、寄存器（内存的访问）

+ 一个字型（word）数据，在内存中的存放，是由 2 个连续地址的内存单元组成，高地址内存单元存放字型数据的高位字节，低地址内存单元存放字型数据的低位字节
+ 栈空间是一段连续的内存单元，即一段连续的内存地址。栈的最大空间为 64KB。
+ 在 8086CPU 中，CPU 将段地址寄存器 SS 和偏移地址寄存器 SP 所组合出来的内存地址当作栈顶标记。